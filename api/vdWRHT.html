<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>vdW interactions and thermal radiation functions · AARMBEM-C.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM-C.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../theory/historicalbackground.html">History</a></li><li><a class="tocitem" href="../theory/theoreticalbackground.html">Theory</a></li><li><a class="tocitem" href="../theory/acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="../implementation/units.html">Units</a></li><li><a class="tocitem" href="../implementation/morse.html">Morse potential for intermolecular internuclear couplings</a></li><li><a class="tocitem" href="../implementation/matrixstorage.html">Matrix storage conventions</a></li><li><a class="tocitem" href="../implementation/datastructuresandtransformations.html">Data structures and rigid transformations</a></li><li><a class="tocitem" href="../implementation/performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="../implementation/outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="../implementation/ewaldwarning.html">Warning: Ewald summation</a></li><li><a class="tocitem" href="../implementation/vdWwarning.html">Warning: vdW interactions</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/configfiles.html">Configuration files</a></li><li><a class="tocitem" href="../usage/transfiles.html">Transformation files</a></li><li><a class="tocitem" href="../usage/periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="../usage/freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="../usage/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../usage/outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/2C250carbynecollinearVAC.html">Two identical mirrored collinear carbyne wires (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li><a class="tocitem" href="greensfunctions.html">Maxwell Green&#39;s functions</a></li><li><a class="tocitem" href="periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li><a class="tocitem" href="moldata.html">Molecular data structures and methods</a></li><li><a class="tocitem" href="DeltaKIdata.html">Intermolecular internuclear coupling data structures and methods</a></li><li><a class="tocitem" href="transdata.html">Transformation data structures and methods</a></li><li class="is-active"><a class="tocitem" href="vdWRHT.html">vdW interactions and thermal radiation functions</a><ul class="internal"><li><a class="tocitem" href="#Thermal-radiation-1"><span>Thermal radiation</span></a></li><li><a class="tocitem" href="#vdW-interactions-1"><span>vdW interactions</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href="vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/psv2/AARMBEM-C.jl/blob/master/doc/src/api/vdWRHT.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="vdW-interactions-and-thermal-radiation-functions-1"><a class="docs-heading-anchor" href="#vdW-interactions-and-thermal-radiation-functions-1">vdW interactions and thermal radiation functions</a><a class="docs-heading-anchor-permalink" href="#vdW-interactions-and-thermal-radiation-functions-1" title="Permalink"></a></h1><h2 id="Thermal-radiation-1"><a class="docs-heading-anchor" href="#Thermal-radiation-1">Thermal radiation</a><a class="docs-heading-anchor-permalink" href="#Thermal-radiation-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="heattransfer" href="#heattransfer"><code>heattransfer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">heattransfer(myARGS)</code></pre><p>Extract command-line arguments for computing the radiative heat transfer among a collection of molecules, then compute the radiative heat transfer appropriately.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"></div></div><p>Any frequencies will be converted to their absolute values. Frequencies are not allowed to be exactly zero.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"></div></div><p>This computes the integrand <span>$\Phi^{(m)}_{n}$</span> at specified real frequencies, without doing any integration. This includes neither numerical prefactors outside of the trace, nor the Planck function.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"></div></div><p>This function can be embarrassingly parallelized over frequency and wavevector. However, the integrand at each frequency and wavevector is calculated for every transformation, as this maximizes the efficiency of the program by virtue of reusing quantities independent of geometric transformations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="heattransfer_general" href="#heattransfer_general"><code>heattransfer_general</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">heattransfer_general(outfilename, myAllMolData, myTransData, myPeriodicData,
                     myDeltaKISystemData, Genvstr, nonretarded, freqklist)</code></pre><p>Compute the actual heat transfer integrands (for conduction, radiation, and both together) and print each to appropriate files based on the name specified by <code>outfilename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L62-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="printPhimn" href="#printPhimn"><code>printPhimn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">printPhimn(Phimn::Array{FT, 2}, outfilename::AbstractString,
           myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
           myTransData::TransData{FT},
           myPeriodicData::PeriodicData{FT},
           tt::Integer, currfreq::Union{FT, Complex{FT}},
           currk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Print the matrix <code>Phimn</code> to the file with name <code>outfilename</code>. The elements <code>Phimn[m, n]</code> represent the energy transfer from molecule <code>m</code> to molecule <code>n</code>, corresponding to the mathematical quantity <span>$\Phi^{(m)}_{n}$</span>. If there is no spatial periodicity, <code>Phimn</code> should be symmetric, and a line of output will be as follows: <code>myTransData.transLabels[tt]</code> <code>currfreq</code> <code>Phimn[1, 1]</code> <code>Phimn[1, 2]</code> ... <code>Phimn[2, 1]</code> <code>Phimn[2, 2]</code> ... for example: <code>TRANS05 1.2340953873461249e+12 -6.3540963812489034e-01 6.3540963812489034e-01 6.3540963812489034e-01 -6.3540963812489034e-01</code>   If there is spatial periodicity, the transpose of <code>Phimn</code> at wavevector <span>$ec{k}$</span> is the equivalent of computing <code>Phimn</code> at <span>$-ec{k}$</span>, and a line of output will be as follows: <code>myTransData.transLabels[tt]</code> <code>currfreq</code> <code>currk[1]</code> <code>currk[2]</code> <code>currk[3]</code> <code>Phimn[1, 1]</code> <code>Phimn[1, 2]</code> ... <code>Phimn[2, 1]</code> <code>Phimn[2, 2]</code> ... for example: <code>TRANS05 1.2340953873461249e+12 5.0000000000000000e+07 3.0000000000000000e+07 0.0000000000000000e+00 -6.3540963812489034e-01 6.3540963812489034e-01 6.3540963812489034e-01 -6.3540963812489034e-01</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L277-L299">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleZIIinvnoDeltaKI!" href="#assembleZIIinvnoDeltaKI!"><code>assembleZIIinvnoDeltaKI!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleZIIinvnoDeltaKI!(totalZIIinvmat::SharedArray{Complex{FT}, 2},
                         myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                         myTransData::TransData{FT},
                         tt::Integer)</code></pre><p>Assemble the matrix <code>totalZIIinvmat</code> in-place for the geometrical transformation with index <code>tt</code>, in the absence of internuclear couplings between different molecules.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L337-L347">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleZIIinvTeeradiation!" href="#assembleZIIinvTeeradiation!"><code>assembleZIIinvTeeradiation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleZIIinvTeeradiation!(totalZIIinvmat::SharedArray{Complex{FT}, 2},
                            totalTeemat::SharedArray{Complex{FT}, 2},
                            totalGenvmat::SharedArray{Complex{FT}, 2},
                            myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                            myTransData::TransData{FT},
                            tt::Integer)</code></pre><p>Assemble the matrices <code>totalZIIinvmat</code> and <code>totalTeemat</code> in-place for the geometrical transformation with index <code>tt</code>, in the absence of internuclear couplings between different molecules but in the presence of radiative couplings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L385-L398">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembletempmateI!" href="#assembletempmateI!"><code>assembletempmateI!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembletempmateI!(tempmat::SharedArray{Complex{FT}, 2},
                   totalTeemat::SharedArray{Complex{FT}, 2},
                   totalZIIinvmat::SharedArray{Complex{FT}, 2},
                   myAllMolData::MolSystem{OneMol_WithPhonons{FT}})</code></pre><p>Assemble the matrix <code>tempmat</code> in-place, equal to <span>$(Z_{\mathrm{ee}} - K_{\mathrm{e}} Z_{\mathrm{II}}^{-1} K_{\mathrm{e}})^{-1} K_{\mathrm{e}} Z_{\mathrm{II}}^{-1}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L440-L450">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assemblePhimnwithBe!" href="#assemblePhimnwithBe!"><code>assemblePhimnwithBe!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemblePhimnwithBe!(Phimn::Array{FT, 2},
                     myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                     myPeriodicData::PeriodicData{FT},
                     tempmat::SharedArray{Complex{FT}, 2},
                     DeltaZImat::SharedArray{Complex{FT}, 2},
                     currfreq::Union{FT, Complex{FT}})</code></pre><p>Assemble the contributions to the matrix <code>Phimn</code> in-place, corresponding to the fluctuating electronic sources (accounting for absorption in both electrons due to radiation and nuclei due to conduction); contributions are added to the existing values of <code>Phimn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L479-L492">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assemblePhimnwithBI!" href="#assemblePhimnwithBI!"><code>assemblePhimnwithBI!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemblePhimnwithBI!(Phimn::Array{FT, 2},
                     myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                     myPeriodicData::PeriodicData{FT},
                     tempmat::SharedArray{Complex{FT}, 2},
                     DeltaZImat::SharedArray{Complex{FT}, 2},
                     currfreq::Union{FT, Complex{FT}})</code></pre><p>Assemble the contributions to the matrix <code>Phimn</code> in-place, corresponding to the fluctuating nuclear sources (accounting for absorption in both electrons due to radiation and nuclei due to conduction); contributions are added to the existing values of <code>Phimn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L548-L561">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assemblePhimnradiation!" href="#assemblePhimnradiation!"><code>assemblePhimnradiation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemblePhimnradiation!(Phimn::Array{FT, 2},
                        myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                        myPeriodicData::PeriodicData{FT},
                        totalTeemat::SharedArray{Complex{FT}, 2},
                        totalGenvmatwithdiag::SharedArray{Complex{FT}, 2},
                        totalZIIinvmat::SharedArray{Complex{FT}, 2},
                        tempmat::SharedArray{Complex{FT}, 2},
                        currfreq::Union{FT, Complex{FT}})</code></pre><p>Assemble the matrix <code>Phimn</code> in-place for purely radiative couplings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L617-L630">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleZIIinvwithDeltaKI!" href="#assembleZIIinvwithDeltaKI!"><code>assembleZIIinvwithDeltaKI!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleZIIinvwithDeltaKI!(totalZIIinvmat::SharedArray{Complex{FT}, 2},
                           DeltaKImat::SharedArray{Complex{FT}, 2},
                           myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                           myTransData::TransData{FT},
                           tt::Integer)</code></pre><p>Assemble the matrix <code>totalZIIinvmat</code> in-place for the geometrical transformation with index <code>tt</code>, in the presence of internuclear couplings between different molecules.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L662-L673">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleZIIinvTeeconduction!" href="#assembleZIIinvTeeconduction!"><code>assembleZIIinvTeeconduction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleZIIinvTeeconduction!(totalZIIinvmat::SharedArray{Complex{FT}, 2},
                             totalTeemat::SharedArray{Complex{FT}, 2},
                             DeltaKImat::SharedArray{Complex{FT}, 2},
                             myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                             myTransData::TransData{FT},
                             tt::Integer)</code></pre><p>Assemble the matrices <code>totalZIIinvmat</code> and <code>totalTeemat</code> in-place for the geometrical transformation with index <code>tt</code>, in the presence of internuclear couplings between different molecules but in the absence of radiative couplings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L713-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembletempmatIe!" href="#assembletempmatIe!"><code>assembletempmatIe!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembletempmatIe!(tempmat::SharedArray{Complex{FT}, 2},
                   totalTeemat::SharedArray{Complex{FT}, 2},
                   totalZIIinvmat::SharedArray{Complex{FT}, 2},
                   myAllMolData::MolSystem{OneMol_WithPhonons{FT}})</code></pre><p>Assemble the matrix <code>tempmat</code> in-place, equal to <span>$Z_{\mathrm{II}}^{-1} K_{\mathrm{e}} (Z_{\mathrm{ee}} - K_{\mathrm{e}} Z_{\mathrm{II}}^{-1} K_{\mathrm{e}})^{-1}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L785-L795">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembletempmatII!" href="#assembletempmatII!"><code>assembletempmatII!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembletempmatII!(tempmat::SharedArray{Complex{FT}, 2},
                   totalTeemat::SharedArray{Complex{FT}, 2},
                   totalZIIinvmat::SharedArray{Complex{FT}, 2},
                   myAllMolData::MolSystem{OneMol_WithPhonons{FT}})</code></pre><p>Assemble the matrix <code>tempmat</code> in-place, equal to <span>$Z_{\mathrm{II}}^{-1} + Z_{\mathrm{II}}^{-1} K_{\mathrm{e}} (Z_{\mathrm{ee}} - K_{\mathrm{e}} Z_{\mathrm{II}}^{-1} K_{\mathrm{e}})^{-1} K_{\mathrm{e}} Z_{\mathrm{II}}^{-1}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L824-L834">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assemblePhimnconduction!" href="#assemblePhimnconduction!"><code>assemblePhimnconduction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemblePhimnconduction!(Phimn::Array{FT, 2},
                         myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                         myPeriodicData::PeriodicData{FT},
                         totalTeemat::SharedArray{Complex{FT}, 2},
                         DeltaKImat::SharedArray{Complex{FT}, 2},
                         totalZIIinvmat::SharedArray{Complex{FT}, 2},
                         tempmat::SharedArray{Complex{FT}, 2},
                         currfreq::Union{FT, Complex{FT}})</code></pre><p>Assemble the matrix <code>Phimn</code> in-place for purely conductive couplings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L880-L893">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleZIIinvTeeboth!" href="#assembleZIIinvTeeboth!"><code>assembleZIIinvTeeboth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleZIIinvTeeboth!(totalZIIinvmat::SharedArray{Complex{FT}, 2},
                       totalTeemat::SharedArray{Complex{FT}, 2},
                       totalGenvmat::SharedArray{Complex{FT}, 2},
                       DeltaKImat::SharedArray{Complex{FT}, 2},
                       myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                       myTransData::TransData{FT},
                       tt::Integer)</code></pre><p>Assemble the matrices <code>totalZIIinvmat</code> and <code>totalTeemat</code> in-place for the geometrical transformation with index <code>tt</code>, in the presence of both radiative and internuclear couplings between different molecules.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L921-L935">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assemblePhimnboth!" href="#assemblePhimnboth!"><code>assemblePhimnboth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemblePhimnboth!(Phimn::Array{FT, 2},
                   myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                   myPeriodicData::PeriodicData{FT},
                   totalTeemat::SharedArray{Complex{FT}, 2},
                   totalGenvmatwithdiag::SharedArray{Complex{FT}, 2},
                   DeltaKImat::SharedArray{Complex{FT}, 2},
                   totalZIIinvmat::SharedArray{Complex{FT}, 2},
                   tempmat::SharedArray{Complex{FT}, 2},
                   currfreq::Union{FT, Complex{FT}})</code></pre><p>Assemble the matrix <code>Phimn</code> in-place for both radiative and conductive couplings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L995-L1009">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleGenvDiagBlock!" href="#assembleGenvDiagBlock!"><code>assembleGenvDiagBlock!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleGenvDiagBlock!(totalGenvmat::SharedArray{Complex{FT}, 2},
                       totalGenvmatwithdiag::SharedArray{Complex{FT}, 2},
                       myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                       myTransData::TransData{FT}, nn2::Integer,
                       currmolind2::Integer, startidx2::Integer,
                       tt::Integer, myPeriodicData::PeriodicData{FT},
                       GFSCAGG!::Function,
                       currfreqG::Union{FT, Complex{FT}},
                       currk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the molecular diagonal block of the scattering Green&#39;s function interaction matrix of molecule <code>nn2</code> (whose unique molecular index <code>currmolind2</code> is precomputed and passed as an argument) at frequency <code>currfreqG</code> and wavevector <code>currk</code> using <code>GFSCAGG!</code>, then add the vacuum contribution of molecule <code>nn2</code>, performing any required matrix rotations corresponding to transformation <code>tt</code> for molecule <code>nn2</code>. Stamp that into <code>totalGenvmat[(startidx2-1).+(1:3*myAllMolData.numatomslist[nn2]), (startidx2-1).+(1:3*myAllMolData.numatomslist[nn2])]</code>, and added to coincident contributions into <code>totalGenvmatwithdiag[(startidx2-1).+(1:3*myAllMolData.numatomslist[nn2]), (startidx2-1).+(1:3*myAllMolData.numatomslist[nn2])]</code>. Finally, undo any rotation corresponding to transformation <code>tt</code> in molecule <code>nn2</code> for reuse with future transformations. This assumes the presence of phonons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L1054-L1077">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleGenvOffDiagBlock!" href="#assembleGenvOffDiagBlock!"><code>assembleGenvOffDiagBlock!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleGenvOffDiagBlock!(totalGenvmat::SharedArray{Complex{FT}, 2},
                          totalGenvmatwithdiag::SharedArray{Complex{FT}, 2},
                          myAllMolData::MolSystem{&lt;:OneMol{FT}},
                          myTransData::TransData{FT},
                          nn1::Integer, nn2::Integer,
                          startidx1::Integer,
                          startidx2::Integer,
                          myPeriodicData::PeriodicData{FT},
                          GFSCAGG!::Function,
                          currfreqG::Union{FT, Complex{FT}},
                          currk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the molecular off-diagonal block of the scattering Green&#39;s function interaction matrix of molecules <code>nn2</code> as the source and <code>nn1</code> as the field (whose respective unique molecular indices <code>currmolind1</code> and <code>currmolind2</code> are precomputed and passed as arguments) at frequency <code>currfreqG</code> and wavevector <code>currk</code> using <code>GFSCAGG!</code>, multiply on the left by the electronic polarizabilities, add the vacuum contribution, and stamp that into <code>totalGenvmat[(startidx2-1).+(1:3*myAllMolData.numatomslist[nn2]), (startidx2-1).+(1:3*myAllMolData.numatomslist[nn2])]</code> and <code>totalGenvmatwithdiag[(startidx2-1).+(1:3*myAllMolData.numatomslist[nn2]), (startidx2-1).+(1:3*myAllMolData.numatomslist[nn2])]</code>. If there is no spatial periodicity, do the same for the (unconjugated) transpose, swapping <code>nn2</code> and <code>nn1</code> without performing further Green&#39;s function computations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/heattransfer.jl#L1115-L1141">source</a></section></article><h2 id="vdW-interactions-1"><a class="docs-heading-anchor" href="#vdW-interactions-1">vdW interactions</a><a class="docs-heading-anchor-permalink" href="#vdW-interactions-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="vdWenergy" href="#vdWenergy"><code>vdWenergy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">vdWenergy(myARGS)</code></pre><p>Extract command-line arguments for computing the vdW interaction energy among a collection of molecules, then compute the vdW energy integrand in imaginary frequency appropriately.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"></div></div><p>Any frequencies will be converted to their absolute values times <code>1im</code>. Frequencies are not allowed to be exactly zero.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"></div></div><p>This computes the integrand <span>$\ln(\det(T_{\infty} T^{-1}))$</span> at specified imaginary frequencies, without doing any integration or Matsubara summation. This is typically a negative dimensionless quantity, and no factors of <span>$2\pi$</span> or <span>$\hbar$</span> are included.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"></div></div><p>This function can be embarrassingly parallelized over frequency and wavevector. However, the integrand at each frequency and wavevector is calculated for every transformation, as this maximizes the efficiency of the program by virtue of reusing quantities independent of geometric transformations.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"></div></div><p>The recommended way to do frequency integration or Matsubara summation is to supply a list of frequencies (typically not too many), and then interpolate the integrand to do integration or Matsubara summation after the fact.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L1-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="vdWenergy_general" href="#vdWenergy_general"><code>vdWenergy_general</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">vdWenergy_general(outfilename, myAllMolData, myTransData, myPeriodicData,
                  myDeltaKISystemData, Genvstr, nonretarded, freqklist)</code></pre><p>Compute the actual vdW energy integrands (for conduction, radiation, and both together) and print each to <code>outfilename</code> (radiation integrand, then conduction integrand, then total integrand).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L65-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="constructMolZI0!" href="#constructMolZI0!"><code>constructMolZI0!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">constructMolZI0!(myMolData::OneMol_WithPhonons{FT},
                 myPeriodicData::PeriodicData{FT},
                 freq::Union{FT, Complex{FT}},
                 k::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Construct the product of the uncoupled nuclear response with the internuclear spring constant matrix of a single molecule. This also constructs the atomic polarizabilities used to evaluate the Gaussian widths used for the Green&#39;s function matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L255-L266">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="constructMolYe0eeGvacinf!" href="#constructMolYe0eeGvacinf!"><code>constructMolYe0eeGvacinf!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">constructMolYe0eeGvacinf!(myMolData::OneMol_WithPhonons{FT},
                          myPeriodicData::PeriodicData{FT},
                          currfreqG::Union{FT, Complex{FT}},
                          currk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the Green&#39;s function interaction matrix of a molecule in vacuum <code>myMolData.GvacGGinf</code>, then multiplies on the left by its electronic response in-place, at frequency <code>currfreqG</code> and wavevector <code>currk</code> passing <code>myMolData</code> and <code>myPeriodicData</code> to the subsidiary functions. This matrix is then subtracted from the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L278-L290">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="computeradintegrandvac" href="#computeradintegrandvac"><code>computeradintegrandvac</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">computeradintegrandvac(tempmat::SharedArray{Complex{FT}, 2},
                       myMolData::OneMol_WithPhonons{FT}) where FT&lt;:AbstractFloat</code></pre><p>Set up the matrix <code>tempmat</code> to compute the vacuum radiative contribution to the vdW energy integrand.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L303-L311">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="integrandvac" href="#integrandvac"><code>integrandvac</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">integrandvac(myAllMolData::MolSystem{&lt;:OneMol{FT}},
             integrandvaclist::Array{FT, 1}) where FT&lt;:AbstractFloat</code></pre><p>Populate the list of vacuum contributions to the vdW integrand <code>integrandvaclist</code> with contributions from duplicate molecules where they exist, then return the sum yielding the total contribution to the integrand in vacuum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L328-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleYe0eeGenvDiagBlock!" href="#assembleYe0eeGenvDiagBlock!"><code>assembleYe0eeGenvDiagBlock!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleYe0eeGenvDiagBlock!(totalYe0eeGenvmat::SharedArray{Complex{FT}, 2},
                            myAllMolData::MolSystem{&lt;:OneMol{FT}},
                            myTransData::TransData{FT}, nn2::Integer,
                            currmolind2::Integer, startidx2::Integer,
                            tt::Integer, myPeriodicData::PeriodicData{FT},
                            GFSCAGG!::Function,
                            currfreqG::Union{FT, Complex{FT}},
                            currk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the molecular diagonal block of the scattering Green&#39;s function interaction matrix of molecule <code>nn2</code> (whose unique molecular index <code>currmolind2</code> is precomputed and passed as an argument) at frequency <code>currfreqG</code> and wavevector <code>currk</code> using <code>GFSCAGG!</code>, and multiply on the left by the electronic response, then add the vacuum contribution which has already been computed as the electronic polarizabilities multiplied by the vacuum Green&#39;s function matrix of molecule <code>nn2</code>, performing any required matrix rotations corresponding to transformation <code>tt</code> for molecule <code>nn2</code>, and stamp that into <code>totalYe0eeGenvmat[(startidx2-1).+(1:3*myAllMolData.numatomslist[nn2]), (startidx2-1).+(1:3*myAllMolData.numatomslist[nn2])]</code>. Finally, undo any rotation corresponding to transformation <code>tt</code> in the vacuum Green&#39;s function matrix of molecule <code>nn2</code> for reuse with future transformations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L353-L375">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleYe0eeGenvOffDiagBlock!" href="#assembleYe0eeGenvOffDiagBlock!"><code>assembleYe0eeGenvOffDiagBlock!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleYe0eeGenvOffDiagBlock!(totalYe0eeGenvmat::SharedArray{Complex{FT}, 2},
                               myAllMolData::MolSystem{&lt;:OneMol{FT}},
                               myTransData::TransData{FT},
                               nn1::Integer, nn2::Integer,
                               startidx1::Integer,
                               startidx2::Integer,
                               myPeriodicData::PeriodicData{FT},
                               GFSCAGG!::Function,
                               currfreqG::Union{FT, Complex{FT}},
                               currk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the molecular off-diagonal block of the scattering Green&#39;s function interaction matrix of molecules <code>nn2</code> as the source and <code>nn1</code> as the field (whose respective unique molecular indices <code>currmolind1</code> and <code>currmolind2</code> are precomputed and passed as arguments) at frequency <code>currfreqG</code> and wavevector <code>currk</code> using <code>GFSCAGG!</code>, multiply on the left by the electronic response, add the vacuum contribution, and stamp that into <code>totalYe0eeGenvmat[(startidx2-1).+(1:3*myAllMolData.numatomslist[nn2]), (startidx2-1).+(1:3*myAllMolData.numatomslist[nn2])]</code>. Do the same for the adjoint, swapping <code>nn2</code> and <code>nn1</code> without performing further Green&#39;s function computations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L408-L430">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleYe0IIDeltaKI!" href="#assembleYe0IIDeltaKI!"><code>assembleYe0IIDeltaKI!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleYe0IIDeltaKI!(Ye0IIDeltaKImat::AbstractArray{Complex{FT}, 2},
                      myDeltaKISystemData::DeltaKISystemData{FT},
                      myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                      blochk::AbstractArray{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Construct the product of the uncoupled nuclear response across all molecules with the internuclear spring constant matrix coupling different molecules.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L476-L486">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="computeradintegrandnoDeltaKI" href="#computeradintegrandnoDeltaKI"><code>computeradintegrandnoDeltaKI</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">computeradintegrandnoDeltaKI(tempmat::SharedArray{Complex{FT}, 2},
                             totalYe0eeGenvmat::SharedArray{Complex{FT}, 2},
                             myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                             myTransData::TransData{FT},
                             tt::Integer) where FT&lt;:AbstractFloat</code></pre><p>Compute and return the total contribution (before subtracting the vacuum contribution) to the vdW energy integrand from radiation in the absence of conductive couplings between different molecules, at transformation index <code>tt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L515-L527">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="computeradintegrandwithDeltaKI" href="#computeradintegrandwithDeltaKI"><code>computeradintegrandwithDeltaKI</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">computeradintegrandwithDeltaKI(tempmat::SharedArray{Complex{FT}, 2},
                               totalYe0eeGenvmat::SharedArray{Complex{FT}, 2},
                               Ye0IIDeltaKImat::SharedArray{Complex{FT}, 2},
                               myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                               myTransData::TransData{FT},
                               tt::Integer) where FT&lt;:AbstractFloat</code></pre><p>Compute and return the total contribution (before subtracting the vacuum contribution) to the vdW energy integrand from radiation in the presence of conductive couplings between different molecules, at transformation index <code>tt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L575-L588">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="computecondintegrandwithDeltaKI" href="#computecondintegrandwithDeltaKI"><code>computecondintegrandwithDeltaKI</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">computecondintegrandwithDeltaKI(tempmat::SharedArray{Complex{FT}, 2},
                                Ye0IIDeltaKImat::SharedArray{Complex{FT}, 2},
                                myAllMolData::MolSystem{OneMol_WithPhonons{FT}},
                                myTransData::TransData{FT},
                                tt::Integer) where FT&lt;:AbstractFloat</code></pre><p>Compute and return the total contribution (with the vacuum contribution vanishing) to the vdW energy integrand from conduction (in the presence of conductive couplings between different molecules), at transformation index <code>tt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM-C.jl/blob/c22d1eb1c62992df94bad9a4823d8c9e3ab39872/src/vdWenergy.jl#L672-L684">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="transdata.html">« Transformation data structures and methods</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 16 June 2020 16:49">Tuesday 16 June 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
